<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/LunaRGod/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/LunaRGod/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" href="https://github.com/LunaRGod/rss.xml"><link rel="alternate" type="application/atom+xml" href="https://github.com/LunaRGod/atom.xml"><link rel="alternate" type="application/json" href="https://github.com/LunaRGod/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/LunaRGod/css/app.css?v=0.2.5"><meta name="keywords" content="java,git,springcloud"><link rel="canonical" href="https://github.com/LunaRGod/2024/05/19/%E4%BA%91%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2/"><title>云安全攻防 - 网络安全 | SABER = = 你越安静 你听到的就越多</title><meta name="generator" content="Hexo 7.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">云安全攻防</h1><div class="meta"><span class="item" title="创建时间：2024-05-19 22:09:49"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2024-05-19T22:09:49+08:00">2024-05-19</time></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/LunaRGod/" rel="start">SABER</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://pic.imgdb.cn/item/67371d23d29ded1a8c8cb0d1.jpg"></li><li class="item" data-background-image="https://pic.imgdb.cn/item/67384616d29ded1a8c750113.png"></li><li class="item" data-background-image="https://pic.imgdb.cn/item/67371d1fd29ded1a8c8cabbe.jpg"></li><li class="item" data-background-image="https://pic.imgdb.cn/item/67384d09d29ded1a8c7b5428.jpg"></li><li class="item" data-background-image="https://pic.imgdb.cn/item/673845ecd29ded1a8c74e034.jpg"></li><li class="item" data-background-image="https://pic.imgdb.cn/item/67371d15d29ded1a8c8c9cd3.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/LunaRGod/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/LunaRGod/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" itemprop="item" rel="index" title="分类于 网络安全"><span itemprop="name">网络安全</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://github.com/LunaRGod/2024/05/19/%E4%BA%91%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/LunaRGod/images/avatar.jpg"><meta itemprop="name" content="月"><meta itemprop="description" content="你越安静 你听到的就越多, 欢迎来到月的个人博客!"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content=""></span><div class="body md" itemprop="articleBody"><p><span class="exturl" data-url="aHR0cHM6Ly9semNsb3Vkc2VjdXJpdHkuZ2l0Ym9vay5pby95dW4tYW4tcXVhbi1nb25nLWZhbmctcnUtbWVu">云安全攻防入门</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvNUNDOXZKdkxjanFMVGlQMGFMS0Npdw==">云资产管理工具</span></p><p><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvMTI1NDM/dGltZV9fMTMxMT1tcW1oRDUwS0JLWUl4V3FHTkRRUklNQzhHT3ppdEQ4YmVE">AK/SK 泄露利用工具 WEB 版</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvVU0tZ3hxMG5wN0cwNS1LVW1yOElHZw==">存储桶 OSS 遍历漏洞利用工具</span></p><p>云安全是一组程序和技术的集合，旨在解决企业安全所面临的外部和内部威胁。将各种云端工具和服务纳入企业基础架构中时，需要云安全保障业务顺利进行，在云存储中，您可以设置不同的权限级别，以控制谁可以访问存储桶中的数据以及以何种方式进行访问。当这些权限配置出现问题时，就会导致潜在的安全风险</p><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvTUVvZE4yY1VHNTVyT25CTXo0OExxQQ==">OSS 红云谈安全</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzYxNTUzNTIwL2FydGljbGUvZGV0YWlscy8xMzcxMjczNDg=">云上攻防 - 云服务篇 &amp; 对象存储 &amp; Bucket 桶 &amp; 任意上传</span></p><p>各大厂商云域名前缀，常见的是阿里云和腾讯云分辨厂商看域名前缀</p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">阿里云: OSS  <span class="comment">// 开头辨识 LTAI  阿里云的临时密钥可以登录</span></span><br><span class="line">腾讯云: COS  <span class="comment">// 开头标识 AKID</span></span><br><span class="line">百度云: </span><br><span class="line"></span><br><span class="line">华为云: OBS</span><br><span class="line">谷歌云: GCS</span><br><span class="line">微软云: Blob</span><br><span class="line">亚马逊云:S3</span><br></pre></td></tr></table></figure><p></p><p><img data-src="image/image_gd55_7yc77.png" alt></p><p><img data-src="image/image_iTeUjXSvH5.png" alt></p><p>存储桶为空利用脚本跑出数据</p><p><img data-src="image/image_qLDitmSFkW.png" alt></p><hr><h2 id="云安全攻防姿势"><a class="anchor" href="#云安全攻防姿势">#</a> 云安全攻防姿势</h2><h3 id="oss存储桶访问配置错误"><a class="anchor" href="#oss存储桶访问配置错误">#</a> OSS 存储桶访问配置错误</h3><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AccessDenied  <span class="comment">// 访问被拒绝说明配置是私有是安全的配置 无法操作啥</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p></p><p><img data-src="image/image_OqD4JnkDMB.png" alt></p><h4 id="公共读信息泄露"><a class="anchor" href="#公共读信息泄露">#</a> 公共读信息泄露</h4><p>权限配置公共读或公共读写也是可以列出目录的但由于没有选择 ** <code>ListObject</code> ** 所以无法显示完整结构目录无法进行第二步拼接 <code>key</code> 访问</p><p><img data-src="image/image_vlyN6TLHk9.png" alt></p><p><img data-src="image/image_fD6gUOko0x.png" alt></p><hr><h4 id="公共读写put文件上传"><a class="anchor" href="#公共读写put文件上传">#</a> 公共读写 <code>PUT</code> 文件上传</h4><p>配置为公共读写代表任何人都可以去上传文件，哪怕不列出目录结构但还是可以利用尝试一下；直接上传会是 <code>403</code> , 操作是直接抓取域名数据包域名后随便跟随一个文件名字下方写入内容，或者利用 <code>ping</code> 此域名得到 <code>oss</code> 解析的 <code>IP</code> 地址进行上传，上传后了就拼接地址测试是否成功</p><p><img data-src="image/image_qsRtxhVX1O.png" alt></p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PUT / <span class="number">1.</span>txt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">你好世界</span><br></pre></td></tr></table></figure><p></p><p><img data-src="image/image_BEthNC6U2B.png" alt></p><p><img data-src="image/image_xJgepCZlhx.png" alt></p><p>上传成功会在目录下</p><p><img data-src="image/image_PNHd1pIPFJ.png" alt></p><hr><h4 id="公共读-listobject-信息泄露"><a class="anchor" href="#公共读-listobject-信息泄露">#</a> 公共读 <code>ListObject</code> 信息泄露</h4><p>配置 公开读和 ** <code>ListObject</code> ** 桶内的 <code>key</code> 信息会全部列出，我们拼接就 <code>key</code> <sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup> 可以全部访问，所以是运气洞</p><p><strong>原理</strong></p><blockquote><p>进行 <code>Bucket</code> 桶创建时，默认的权限为<strong>私有</strong>权限，如果配置是公共读或者公共读写的情况下并且 <code>Bucket</code> 授权策略设置成 <code>ListObject</code> 将导致遍历存储桶，</p></blockquote><p><strong>公开读</strong></p><p><img data-src="image/image_WPA45OvYh3.png" alt></p><p><strong><code>Bucket</code> <strong><strong>授权策略设置</strong></strong> <code>ListObject</code> </strong><sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup></p><p><img data-src="image/image_FEdtpFCb-Q.png" alt></p><p>配置错误导致存储桶信息泄露，拼接 <code>Key</code> 中的值导致信息泄露</p><p><img data-src="image/image_qGLCygQFxg.png" alt></p><hr><h4 id="判断网站是否绑定云存储"><a class="anchor" href="#判断网站是否绑定云存储">#</a> 判断网站是否绑定云存储</h4><p>网站绑定了云存储桶上传文件 <code>inde</code> 直接访问会下载不会解析所以上传木马是无用的</p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//xiaodigay.oss-cn-wuhan-lr.aliyuncs.com/index.html // 不解析</span></span><br></pre></td></tr></table></figure><p></p><p><img data-src="image/image_Ma0bDC44_J.png" alt></p><p>但是存储桶对应解析的域名访问上传的 <code>index</code> 会做解析</p><p><img data-src="image/image_yq1rH9GA_5.png" alt></p><p>第一个是肉眼看域名很长并且出现了 <code>yun</code> 字眼代表是阿里云，看 <code>ping</code> 地址是否回显 IP</p><hr><h3 id="阿里云桶接管nosuchbucket"><a class="anchor" href="#阿里云桶接管nosuchbucket">#</a> 阿里云桶接管 <code>NoSuchBucket</code></h3><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDQ2NDU2MC9hcnRpY2xlL2RldGFpbHMvMTE5ODQyMDI5">阿里云 OSS 存储 Bucket 劫持漏洞_nosuchbucket</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MDQxODQ1Ny9hcnRpY2xlL2RldGFpbHMvMTE3NTI0Nzc1">一次成功的云存储接管实战_阿里云存储桶接管</span></p><p><strong>原理</strong></p><p>管理员通过域名绑定了存储桶，这个桶不需要了删除了，但是域名解析 <code>CNAME</code> 没有删除它是 &quot; <code>Canonical Name</code> &quot; 的缩写一种 DNS 记录类型，域名指向到了桶的地址，域名可以访问到这个桶，虽然桶无了但是域名还是访问，就会出现 <code>NoSuchBucket</code> , 出现这种就尝试阿里云劫持存储桶，接管前提是需要在传输管理配置绑定域名</p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">NoSuchBucket  <span class="comment">// 出现代表可接管</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p></p><p><img data-src="image/image__eRuvrQzZD.png" alt></p><p>对方用的什么云存储桶你就用什么云存储桶，对方存储桶地域是什么，新建的时候也要选择对应的地域</p><p><img data-src="image/image_6WNhNxU1v4.png" alt></p><h3 id="预签名链接功能点"><a class="anchor" href="#预签名链接功能点">#</a> 预签名链接功能点</h3><p><code>oss</code> 预签名链接功能点，请求内出现未签名的链接，响应包是已签名的链接，链接签名前不能访问 预签名后的才可以访问，所有需要想办法将网站的其他链接得到使其预签名，最好的就是根目录了所以需要绕过</p><p><img data-src="image/image_xYRS2Z2lTu.png" alt></p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//tend //使其绕过为根目录再发送 就是对根目录进行签名,那么生成的链接访问了网站所有路径了</span></span><br><span class="line"></span><br><span class="line">fuzz绕过:</span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">/%<span class="number">20</span></span><br><span class="line">%<span class="number">20</span></span><br><span class="line"><span class="comment">///</span></span><br><span class="line">/..;/</span><br><span class="line">/a/b/d../../../</span><br><span class="line">.json</span><br><span class="line">?id=<span class="number">1</span></span><br></pre></td></tr></table></figure><p></p><p>签名后的根路径访问所有的桶</p><p><img data-src="image/image_Tw5mLmqmQ3.png" alt></p><h3 id="云服务器ssrf漏洞"><a class="anchor" href="#云服务器ssrf漏洞">#</a> <span class="exturl" data-url="aHR0cHM6Ly9jbG91ZHNlYy5odW94aWFuLmNuL2RvY3MvYXJ0aWNsZXMvYWxpeXVuL3Rha2VvdmVyX2FsaXl1bl9jb25zb2xlIzB4MDUtJUU2JTgwJUJCJUU3JUJCJTkz">云服务器 SSRF 漏洞</span></h3><p>云上 <code>SSRF</code> 漏洞访问元数据，如果配置了 <code>RAM</code> 角色意味着可以获取到临时密钥，通过 SSRF 得到临时秘钥并利用密匙创建了子用户并赋予管理员访问权限，最后通过这个子用户接管了目标的控制台。</p><h3 id="更改参数大小导致拒绝服务"><a class="anchor" href="#更改参数大小导致拒绝服务">#</a> 更改参数大小导致拒绝服务</h3><p><strong>原理</strong></p><blockquote><p>遍历存储桶时由于 <code>max-keys</code> 参数可控，我们通过更改它的大小请求服务器，服务器通过大小返回给前端。占用了资源我们更改它的值并且重复发包，响应时间国产造成拒绝服务</p></blockquote><p><img data-src="image/image_q-1CHdh2QK.png" alt></p><h3 id="腾讯云配置错误列出所有"><a class="anchor" href="#腾讯云配置错误列出所有">#</a> 腾讯云配置错误列出所有</h3><p>腾讯云的授权策略中 <code>action</code> 设置为 <code>cos:ListMultipartUploads</code> , 这意味着将列出所有的分段上传任务</p><blockquote><p><code>List Multipart Uploads</code> 用于查询正在进行中的分块上传任务。单次请求操作最多列出 1000 个正在进行中的分块上传</p></blockquote><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">GET /?uploads HTTP/<span class="number">1.1</span>  <span class="comment">// 域名后跟随 /?upload 配置错误将列出所有文件</span></span><br><span class="line"></span><br><span class="line">Host: &lt;BucketName-APPID&gt;.cos.&lt;Region&gt;.myqcloud.com</span><br><span class="line">Date: GMT Date</span><br><span class="line">Authorization: Auth String</span><br></pre></td></tr></table></figure><p></p><p><img data-src="image/image_hVR161G-VN.png" alt></p><hr><h3 id="sts-临时密匙"><a class="anchor" href="#sts-临时密匙">#</a> <code>STS</code> 临时密匙</h3><p>阿里云 <code>STS</code> 是一种云安全服务，用于为阿里云 <code>RAM</code> 用户（或其他云账号）颁发临时的安全令牌，以便在一定时间内访问阿里云资源，从而实现安全授权和身份验证的目的</p><p><span class="exturl" data-url="aHR0cHM6Ly9oZWxwLmFsaXl1bi5jb20vemgvb3NzL2RldmVsb3Blci1yZWZlcmVuY2UvdXNlLXRlbXBvcmFyeS1hY2Nlc3MtY3JlZGVudGlhbHMtcHJvdmlkZWQtYnktc3RzLXRvLWFjY2Vzcy1vc3M=">使用 STS 临时访问凭证访问 OSS_对象存储 (OSS)</span></p><p><strong>临时密钥的使用</strong></p><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvZlpNbUZhYUZwRWMtWnowYlNnLXFaZw==">STStoken 覆盖文件</span></p><p>把临时的密钥获取到之后再去找一些登录的脚本，去百度云某某云去搜索它临时脚本的使用获取到之后再去对它的一个文件进行上传覆盖，可以覆盖就是可行</p><hr><p>阿里云的临时密钥 <code>sts</code> 直接用 <code>OSS</code> 浏览器登录就行了，如果是挖到这个 <code>OSS</code> 密钥之后如果它提示不是 <code>srcess</code> 错误或者是密钥错误，登录不上去的话就找桶名，把桶名登录上去可能会上去，因为我们找的 OSS 密钥可能不是全部的，可能只是一个桶，所以我们要找桶名把桶名对应上去，桶名就是全局找 网站的上传点下载点 图片加载这或者是去第三方官网，下载它的 <code>Javademo</code> 去调用，那么可以通过 <code>Javademo</code> 给反馈出来</p><h3 id="阿里云接管控制台无告警"><a class="anchor" href="#阿里云接管控制台无告警">#</a> <span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvNHVqc1QyYjRxNVBLaEFyWUFqSHVvUQ==">阿里云接管控制台无告警</span></h3><h2 id="云安全密匙ak-sk"><a class="anchor" href="#云安全密匙ak-sk">#</a> 云安全密匙 AK SK</h2><p>云的挖掘都是密钥的泄露，泄露后我们才可以获取到 <code>Access_token</code> （api）</p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">AccessKeyID :(AK)用于标示用户</span><br><span class="line"></span><br><span class="line">SecretAccessKey :(SK)是用户用于加密认证字符串和云厂商用来验证认证字符串的密钥</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SK必须保密,AK/SK原理使用对称加解密</span><br></pre></td></tr></table></figure><p></p><p>使用 AK/SK 凭证对主机进行绑定</p><p><img data-src="image/image_tgIb6YvmUz.png" alt></p><h3 id="ak-sk查找"><a class="anchor" href="#ak-sk查找">#</a> <code>AK SK</code> 查找</h3><h4 id="js代码泄露"><a class="anchor" href="#js代码泄露">#</a> <code>JS</code> <strong>代码泄露</strong></h4><ul><li>企业登录场景右键源码全局查看是否存在 <code>appsecret appid</code> , 因为所有的这种都是唯一的，所以利用唯一性去 <code>github</code> 上看看是不是泄露，如果有 <code>code</code> 字段我们就成功了</li><li>利用时光机，把登录的站点放到时光机中调整时间，在调整的时间上看 JS 找对应的 <code>Appsecret</code> , 全网只有一个然后拼接使用</li></ul><h4 id="github仓库泄露"><a class="anchor" href="#github仓库泄露">#</a> <code>GitHub</code> <strong>仓库泄露</strong></h4><p>通过语法找到相关的文件进行下载到本地，利用 <code>Vscode</code> 全局查找关键字</p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入某公司某域名</span><br><span class="line"></span><br><span class="line">search?q=  appsecret  + appid  &amp;type=code</span><br></pre></td></tr></table></figure><p></p><p>找到过后要分辨属于哪家，是阿里云的还是腾讯的然后去官网下载对应的工具填写我们找的数据试试看是否可以登录，但是 <code>GitHub</code> 泄露肯定是个人的，如果是在项目中找到那肯定是高危</p><h4 id="企业注册上传图片泄露"><a class="anchor" href="#企业注册上传图片泄露">#</a> 企业注册上传图片泄露</h4><p>文件上传后抓包直接泄露 <code>AK SK</code> 由于图片全部上传到了桶中，所以上传功能点泄露风险比较大</p><p><img data-src="image/image_BcWbXjDaYy.png" alt></p><h4 id="app反编译"><a class="anchor" href="#app反编译">#</a> <code>APP</code> <strong>反编译</strong></h4><p>反编译为 APK 文件后进行根据全局查找关键字</p><p></p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ak/sk</span><br><span class="line"></span><br><span class="line">appid </span><br><span class="line">appkey</span><br><span class="line">appsecret </span><br><span class="line">secret <span class="comment"># 腾讯云 Secretid SecretKey</span></span><br><span class="line"></span><br><span class="line">oss</span><br><span class="line">cos</span><br><span class="line">bos</span><br><span class="line"></span><br><span class="line">access_key</span><br></pre></td></tr></table></figure><p></p><p><strong>批量反编译</strong></p><p><img data-src="image/111_GFR-THs8D2.png" alt></p><h4 id="小程序反编译"><a class="anchor" href="#小程序反编译">#</a> 小程序反编译</h4><p>实战遇到上传到存储桶情况，小程序或者 <code>APP</code> , 上传完成并没有产生任何的数据包代表上传需要的 <code>AKSK</code> 前端存储了所以跨域反编译小程序或者 <code>APP</code> 得到 <code>AKSK</code></p><p><span class="exturl" data-url="aHR0cDovL21wLndlaXhpbi5xcS5jb20vcz9fX2Jpej1Nekl3TXpJeU1qWXpOQT09JmFtcDttaWQ9MjI0NzUxNDA5MiZhbXA7aWR4PTEmYW1wO3NuPWQwMjkwODcwOGI1NDI0ZjIzZTUxNWUwOThlN2Q2Mjc2JmFtcDtjaGtzbT05NmQwNGNlOWExYTdjNWZmZjRiNWQ5Yjk2ZjEwMDFiMjJiYjAzZTVjNWMwNmFlNTgxZDhiZjY4OWM2MDE4Njg3YjVmMTk3MDI5OTI3JmFtcDttcHNoYXJlPTEmYW1wO3NjZW5lPTI0JmFtcDtzcmNpZD0wNTMwdXNhTjlIZ2w2NDY4ZHNjVHRLYTEmYW1wO3NoYXJlcl9zaGFyZWluZm89M2UxZDkxN2VkOTgyNGI1NDFiOTg5YWY5M2NjMWJmZDEmYW1wO3NoYXJlcl9zaGFyZWluZm9fZmlyc3Q9M2UxZDkxN2VkOTgyNGI1NDFiOTg5YWY5M2NjMWJmZDEjcmQ=">反编译教程</span></p><p>获取小程序的源码和 APP 的源码，通过微信开发者工具全局找关键字。尽量使用手工 + 工具，很多时候对参数进行了简写</p><p><img data-src="image/image_tCvkw_OknK.png" alt></p><h4 id="泄露防御方式"><a class="anchor" href="#泄露防御方式">#</a> 泄露防御方式</h4><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">云主机AK/SK信息泄露是一种非常严重的安全问题，可能导致云主机被非法访问和控制，引发各种安全问题。以下是一些防御云主机AK/SK信息泄露的措施：</span><br><span class="line"></span><br><span class="line">安全设置：配置云主机的安全选项，例如使用强密码、开启防火墙、限制远程访问等</span><br><span class="line"></span><br><span class="line">安全审计：定期进行安全审计，检查云主机的安全性，发现潜在的安全问题并及时修复</span><br><span class="line"></span><br><span class="line">定期更换：建议定期更换AK/SK信息，避免长期使用同一组AK/SK信息导致泄露风险增加</span><br><span class="line"></span><br><span class="line">日志监控：开启云主机的日志监控，包括登录日志、系统日志等，及时发现异常情况并采取相应措施</span><br><span class="line"></span><br><span class="line">访问限制：开启IP白名单，限制仅允许特定的IP地址进行远程访问，并且只开放必要端口，例如:HTTP/HTTPS</span><br><span class="line"></span><br><span class="line">安全存储：妥善保管AK/SK信息，避免泄露。AK/SK信息可以存储在安全的密钥管理系统中，例如:AWS KMS等</span><br><span class="line"></span><br><span class="line">安全培训：对云主机管理员和相关工作人员进行安全培训，提高他们的安全意识和技能，避免人为失误导致安全问题</span><br></pre></td></tr></table></figure><p></p><h3 id="漏洞利用"><a class="anchor" href="#漏洞利用">#</a> 漏洞利用</h3><p><span class="exturl" data-url="aHR0cHM6Ly9mb3J1bS5idXRpYW4ubmV0L3NoYXJlLzIzNzY=">奇安信攻防社区 - 云主机秘钥泄露及利用</span></p><h4 id="阿里oss工具登录"><a class="anchor" href="#阿里oss工具登录">#</a> <a href="https://github.com/aliyun/oss-browser" title="阿里OSS工具登录">阿里 OSS 工具登录</a></h4><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">AccessKeyld</span><br><span class="line">AccessKeySecret</span><br><span class="line"></span><br></pre></td></tr></table></figure><p></p><p><img data-src="image/image_7knQ0tuMx8.png" alt></p><h4 id="腾讯云云主机接管平台"><a class="anchor" href="#腾讯云云主机接管平台">#</a> <span class="exturl" data-url="aHR0cHM6Ly9jb3Nicm93c2VyLmNsb3VkLnRlbmNlbnQuY29tL2xvZ2luLz9yX3BhdGg9JTJGd2ViJTJGYnVja2V0">腾讯云云主机接管平台</span></h4><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SecretId  </span><br><span class="line">SecretKey</span><br></pre></td></tr></table></figure><p></p><p><img data-src="image/image_JCrsRQKwh7.png" alt></p><h4 id="行云管家多家厂商"><a class="anchor" href="#行云管家多家厂商">#</a> <span class="exturl" data-url="aHR0cHM6Ly95dW4uY2xvdWRiaWxpdHkuY29tL2xvZ2luLmh0bWw=">行云管家多家厂商</span></h4><p><img data-src="image/image_YQdwaOZ2wm.png" alt></p><h4 id="cf-云环境利用框架"><a class="anchor" href="#cf-云环境利用框架">#</a> <a href="https://github.com/teamssix/cf/releases" title="CF 云环境利用框架">CF 云环境利用框架</a></h4><h2 id="小程序-sessionkeyiv泄露"><a class="anchor" href="#小程序-sessionkeyiv泄露">#</a> 小程序 <code>sessionKey</code> + <code>iv</code> 泄露</h2><p><span class="exturl" data-url="aHR0cDovL21wLndlaXhpbi5xcS5jb20vcz9fX2Jpej1Nekl3TXpJeU1qWXpOQT09JmFtcDttaWQ9MjI0NzUxNDA5MiZhbXA7aWR4PTEmYW1wO3NuPWQwMjkwODcwOGI1NDI0ZjIzZTUxNWUwOThlN2Q2Mjc2JmFtcDtjaGtzbT05NmQwNGNlOWExYTdjNWZmZjRiNWQ5Yjk2ZjEwMDFiMjJiYjAzZTVjNWMwNmFlNTgxZDhiZjY4OWM2MDE4Njg3YjVmMTk3MDI5OTI3JmFtcDttcHNoYXJlPTEmYW1wO3NjZW5lPTI0JmFtcDtzcmNpZD0wNTMwdXNhTjlIZ2w2NDY4ZHNjVHRLYTEmYW1wO3NoYXJlcl9zaGFyZWluZm89M2UxZDkxN2VkOTgyNGI1NDFiOTg5YWY5M2NjMWJmZDEmYW1wO3NoYXJlcl9zaGFyZWluZm9fZmlyc3Q9M2UxZDkxN2VkOTgyNGI1NDFiOTg5YWY5M2NjMWJmZDEjcmQ=">小程序自动化渗透工具</span></p><p><strong>小程序第一次登录出现的是否允许微信授权当前信息，和个人信息功能点</strong>，点击允许后进行抓包，看响应中是否出现 <code>seesionKey</code> <code>iv</code> 加密数据，前后包多看看</p><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvUTVvbnd3RFgyNy1vNVlyV1Z2anVPdw==">泄露 sessionKey iv 任意用户登录</span></p><blockquote><p>根据微信开发者文档发现. <code>sesionkey</code> 是 <code>encryptedDate</code> 的加密密钥，不应该返回给用户，如果返回中出现了 <code>sesionkey</code> + <code>iv</code> 成功解密了加密的数据，那么在登录阶段就可以任意替换手机号进行加密，实现任意用户登录；</p></blockquote><p>这个不属于云安全，利用方式通过百度网盘提供的脚本 替换对应的位置 然后生成新的加密数据号码实现任意用户登录。存在二重认证的情况是登录进去了 拿不到数据只是一个置位效果，没有二重认证的话就是高危</p><p></p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">encryptedDate: 用户加密数据手机号这些</span><br><span class="line"></span><br><span class="line">sesionkey: 解密encryptedDate加密数据的密匙(seesionKey 一般是不会改变的  改变的话就是没办法利用)</span><br><span class="line"></span><br><span class="line">iv: 增加密码强度和安全性的随机数值</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p></p><p><img data-src="image/7_2WkmsPuxPY.png" alt></p><p>** <code>PHP</code> **<strong> 解密脚本</strong></p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"><span class="comment">// 接收到现有的3个值</span></span><br><span class="line"></span><br><span class="line">echo <span class="string">&quot;请输⼊SessionKey: &quot;</span>;</span><br><span class="line">$sessionKey = fgets(STDIN);</span><br><span class="line">echo <span class="string">&quot;请输⼊本次解密IV: &quot;</span>;</span><br><span class="line">$iv = fgets(STDIN);</span><br><span class="line">echo <span class="string">&quot;请输⼊待加密内容: &quot;</span>;</span><br><span class="line">$decryptedData = fgets(STDIN);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义函数作为形参</span></span><br><span class="line">function <span class="title function_">encryptData</span><span class="params">($decryptedData, $iv, $sessionKey)</span></span><br><span class="line">&#123;</span><br><span class="line"> $aesIV = base64_decode($iv);</span><br><span class="line"> $aesCipher = $decryptedData;</span><br><span class="line"> $aesKey = base64_decode($sessionKey);</span><br><span class="line"> $result = openssl_encrypt($aesCipher, $aesKey, <span class="number">0</span>, $aesI</span><br><span class="line">V);</span><br><span class="line"> $dataObj = json_decode($result);</span><br><span class="line"> <span class="keyword">return</span> $result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h2 id="oauth20原理"><a class="anchor" href="#oauth20原理">#</a> <code>Oauth2.0</code> <strong>原理</strong></h2><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvdWc5OWtOQXBuSnB2eTZKZTFWblFudw==">OA2.0 挖掘姿势</span></p><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vaGVsbG93aHkvcC8xNTUzMzYyNS5odG1s">博客园 OA2.0 挖掘姿势</span></p><p>利用：账户登录进后绑定微信 <code>code</code></p><p><code>baidu.com</code> 存在微信第三方绑定或者登录，微信给他一个 <code>secretkey</code> 和 <code>appid</code> 可以调用微信的 <code>api</code> , 所以网站会生成一个二维码，用户扫了之后微信再返回给用户一个独一无二的 <code>code</code> , 谁用了这个 <code>code</code> 就会绑定到谁的微信上去。我的 <code>code</code> 让别人扫了，那么我的微信就绑定了别人的网站信息，造成账号接管</p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">核心:</span><br><span class="line"></span><br><span class="line">扫码过后Burp抓取微信生成属于自己的code 但是我们给别人用,受害者点击了那么自己的微信绑定了受害者在网页上的账户</span><br><span class="line"> 前提是受害者在当前的网站是登录状态并且没有去绑定微信登录,只是简单的利用手机号登录 ,我们则去绑定微信</span><br><span class="line"> </span><br><span class="line">通过将抓取到的Code请求制作POC,发送给受害者造成csrf 他的账户可以绑定我们的微信</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p></p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">利用:</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> 网站显示出二维码 我们打开Burp拦截</span><br><span class="line"><span class="number">2.</span> 开启扫码二维码做出反应 回调生成Code 我们抓取auth_code=xxxx</span><br><span class="line"><span class="number">3.</span> 将Code包制作为POC,并把包丢弃</span><br><span class="line"><span class="number">4.</span> 将POC发送给受害者,他如果正在登录这个网站那么它的网站账户就可以绑定我们的微信</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p></p><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>并不是文件夹只是连在一起的数据和字符串路径一样的 <a href="#fnref1" class="footnote-backref">↩︎</a></p></li><li id="fn2" class="footnote-item"><p>此参数代表显示完整结构目录。那么目录会被全部列出，如果只是公共读 / 写，只能看到一点信息；关键参数 <code>key</code> 不存在不能拼接 <a href="#fnref2" class="footnote-backref">↩︎</a></p></li></ol></section></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2024-08-27 22:50:40" itemprop="dateModified" datetime="2024-08-27T22:50:40+08:00">2024-08-27</time></span></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>月 <i class="ic i-at"><em>@</em></i></li><li class="link"><strong>本文链接：</strong> <a href="https://github.com/LunaRGod/2024/05/19/%E4%BA%91%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2/" title="云安全攻防">https://github.com/LunaRGod/2024/05/19/云安全攻防/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC96aC1DTg=="><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/LunaRGod/2024/05/15/%E4%BB%A3%E7%90%86%E8%BD%AF%E4%BB%B6%E6%8A%80%E6%9C%AF-%20%20CS-MSF%E4%BB%A3%E7%90%86%E8%B7%B3%E6%9D%BF/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;pic.imgdb.cn&#x2F;item&#x2F;673845ecd29ded1a8c74e034.jpg" title="代理软件 &amp; CS&#x2F;MSF代理跳板"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 内网隧道代理</span><h3>代理软件 & CS/MSF代理跳板</h3></a></div><div class="item right"><a href="/LunaRGod/2024/06/09/%E9%9D%9E%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE%20%E9%9D%9E%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE%20%E9%9D%B6%E5%9C%BA/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;pic.imgdb.cn&#x2F;item&#x2F;6738468cd29ded1a8c756b4c.jpg" title="非约束委派 非约束委派 靶场"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 内网攻防</span><h3>非约束委派 非约束委派 靶场</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%91%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2%E5%A7%BF%E5%8A%BF"><span class="toc-number">1.</span> <span class="toc-text">云安全攻防姿势</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#oss%E5%AD%98%E5%82%A8%E6%A1%B6%E8%AE%BF%E9%97%AE%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF"><span class="toc-number">1.1.</span> <span class="toc-text">OSS 存储桶访问配置错误</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%AC%E5%85%B1%E8%AF%BB%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2"><span class="toc-number">1.1.1.</span> <span class="toc-text">公共读信息泄露</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%AC%E5%85%B1%E8%AF%BB%E5%86%99put%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">1.1.2.</span> <span class="toc-text">公共读写 PUT 文件上传</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%AC%E5%85%B1%E8%AF%BB-listobject-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2"><span class="toc-number">1.1.3.</span> <span class="toc-text">公共读 ListObject 信息泄露</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E7%BD%91%E7%AB%99%E6%98%AF%E5%90%A6%E7%BB%91%E5%AE%9A%E4%BA%91%E5%AD%98%E5%82%A8"><span class="toc-number">1.1.4.</span> <span class="toc-text">判断网站是否绑定云存储</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%BF%E9%87%8C%E4%BA%91%E6%A1%B6%E6%8E%A5%E7%AE%A1nosuchbucket"><span class="toc-number">1.2.</span> <span class="toc-text">阿里云桶接管 NoSuchBucket</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%84%E7%AD%BE%E5%90%8D%E9%93%BE%E6%8E%A5%E5%8A%9F%E8%83%BD%E7%82%B9"><span class="toc-number">1.3.</span> <span class="toc-text">预签名链接功能点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8ssrf%E6%BC%8F%E6%B4%9E"><span class="toc-number">1.4.</span> <span class="toc-text">云服务器 SSRF 漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%94%B9%E5%8F%82%E6%95%B0%E5%A4%A7%E5%B0%8F%E5%AF%BC%E8%87%B4%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.5.</span> <span class="toc-text">更改参数大小导致拒绝服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%85%BE%E8%AE%AF%E4%BA%91%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF%E5%88%97%E5%87%BA%E6%89%80%E6%9C%89"><span class="toc-number">1.6.</span> <span class="toc-text">腾讯云配置错误列出所有</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sts-%E4%B8%B4%E6%97%B6%E5%AF%86%E5%8C%99"><span class="toc-number">1.7.</span> <span class="toc-text">STS 临时密匙</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%BF%E9%87%8C%E4%BA%91%E6%8E%A5%E7%AE%A1%E6%8E%A7%E5%88%B6%E5%8F%B0%E6%97%A0%E5%91%8A%E8%AD%A6"><span class="toc-number">1.8.</span> <span class="toc-text">阿里云接管控制台无告警</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%91%E5%AE%89%E5%85%A8%E5%AF%86%E5%8C%99ak-sk"><span class="toc-number">2.</span> <span class="toc-text">云安全密匙 AK SK</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ak-sk%E6%9F%A5%E6%89%BE"><span class="toc-number">2.1.</span> <span class="toc-text">AK SK 查找</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#js%E4%BB%A3%E7%A0%81%E6%B3%84%E9%9C%B2"><span class="toc-number">2.1.1.</span> <span class="toc-text">JS 代码泄露</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#github%E4%BB%93%E5%BA%93%E6%B3%84%E9%9C%B2"><span class="toc-number">2.1.2.</span> <span class="toc-text">GitHub 仓库泄露</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%81%E4%B8%9A%E6%B3%A8%E5%86%8C%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87%E6%B3%84%E9%9C%B2"><span class="toc-number">2.1.3.</span> <span class="toc-text">企业注册上传图片泄露</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#app%E5%8F%8D%E7%BC%96%E8%AF%91"><span class="toc-number">2.1.4.</span> <span class="toc-text">APP 反编译</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%8F%8D%E7%BC%96%E8%AF%91"><span class="toc-number">2.1.5.</span> <span class="toc-text">小程序反编译</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%84%E9%9C%B2%E9%98%B2%E5%BE%A1%E6%96%B9%E5%BC%8F"><span class="toc-number">2.1.6.</span> <span class="toc-text">泄露防御方式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="toc-number">2.2.</span> <span class="toc-text">漏洞利用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%98%BF%E9%87%8Coss%E5%B7%A5%E5%85%B7%E7%99%BB%E5%BD%95"><span class="toc-number">2.2.1.</span> <span class="toc-text">阿里 OSS 工具登录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%85%BE%E8%AE%AF%E4%BA%91%E4%BA%91%E4%B8%BB%E6%9C%BA%E6%8E%A5%E7%AE%A1%E5%B9%B3%E5%8F%B0"><span class="toc-number">2.2.2.</span> <span class="toc-text">腾讯云云主机接管平台</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%8C%E4%BA%91%E7%AE%A1%E5%AE%B6%E5%A4%9A%E5%AE%B6%E5%8E%82%E5%95%86"><span class="toc-number">2.2.3.</span> <span class="toc-text">行云管家多家厂商</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#cf-%E4%BA%91%E7%8E%AF%E5%A2%83%E5%88%A9%E7%94%A8%E6%A1%86%E6%9E%B6"><span class="toc-number">2.2.4.</span> <span class="toc-text">CF 云环境利用框架</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E7%A8%8B%E5%BA%8F-sessionkeyiv%E6%B3%84%E9%9C%B2"><span class="toc-number">3.</span> <span class="toc-text">小程序 sessionKey + iv 泄露</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#oauth20%E5%8E%9F%E7%90%86"><span class="toc-number">4.</span> <span class="toc-text">Oauth2.0 原理</span></a></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/LunaRGod/2024/02/19/%E5%8A%A0%E8%A7%A3%E5%AF%86/" rel="bookmark" title="加解密算法逆向密文">加解密算法逆向密文</a></li><li><a href="/LunaRGod/2024/03/29/JS%E9%80%86%E5%90%91-%E6%9E%84%E9%80%A0/" rel="bookmark" title="JSFuzz-逆向构造数据包">JSFuzz-逆向构造数据包</a></li><li class="active"><a href="/LunaRGod/2024/05/19/%E4%BA%91%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2/" rel="bookmark" title="云安全攻防">云安全攻防</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="月" data-src="/LunaRGod/images/avatar.jpg"><p class="name" itemprop="name">月</p><div class="description" itemprop="description">欢迎来到月的个人博客!</div></div><nav class="state"><div class="item posts"><a href="/LunaRGod/archives/"><span class="count">21</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/LunaRGod/categories/"><span class="count">6</span> <span class="name">分类</span></a></div></nav><div class="social"><a href="https://github.com/LunaRGod" title="https:&#x2F;&#x2F;github.com&#x2F;LunaRGod" class="item github"><i class="ic i-github"></i></a> <span class="exturl item twitter" data-url="aHR0cHM6Ly94LmNvbS95dWVzZTEwMjkxMDQ1Mw==" title="https:&#x2F;&#x2F;x.com&#x2F;yuese102910453"><i class="ic i-twitter"></i></span> <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS9mZW5nLWppYW4tNDgtNjc=" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;feng-jian-48-67"><i class="ic i-zhihu"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTE2NjY5MDk3ODQ=" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;1666909784"><i class="ic i-cloud-music"></i></span> <span class="exturl item email" data-url="bWFpbHRvOnNhYmVyMGRheUBxcS5jb20=" title="mailto:saber0day@qq.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/LunaRGod/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/LunaRGod/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/LunaRGod/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/LunaRGod/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/LunaRGod/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/LunaRGod/2024/05/15/%E4%BB%A3%E7%90%86%E8%BD%AF%E4%BB%B6%E6%8A%80%E6%9C%AF-%20%20CS-MSF%E4%BB%A3%E7%90%86%E8%B7%B3%E6%9D%BF/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/LunaRGod/2024/06/09/%E9%9D%9E%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE%20%E9%9D%9E%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE%20%E9%9D%B6%E5%9C%BA/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/LunaRGod/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" title="分类于 网络安全">网络安全</a></div><span><a href="/LunaRGod/2024/05/19/%E4%BA%91%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2/" title="云安全攻防">云安全攻防</a></span></li><li class="item"><div class="breadcrumb"><a href="/LunaRGod/categories/Java/" title="分类于 Java">Java</a></div><span><a href="/LunaRGod/2023/05/01/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="Java--反序列化">Java--反序列化</a></span></li><li class="item"><div class="breadcrumb"><a href="/LunaRGod/categories/%E5%86%85%E7%BD%91%E6%94%BB%E9%98%B2/" title="分类于 内网攻防">内网攻防</a></div><span><a href="/LunaRGod/2024/09/19/%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8%E5%88%A9%E7%94%A8%E6%80%BB%E7%BB%93/" title="横向移动利用总结">横向移动利用总结</a></span></li><li class="item"><div class="breadcrumb"><a href="/LunaRGod/categories/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E4%BB%A3%E7%90%86/" title="分类于 内网隧道代理">内网隧道代理</a></div><span><a href="/LunaRGod/2024/05/01/%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF-%20DNS-SSH%20%20Linux%E5%8F%8D%E5%90%91%E4%B8%8A%E7%BA%BF/" title="隧道技术&amp; DNS&#x2F;SSH Linux反向上线">隧道技术& DNS/SSH Linux反向上线</a></span></li><li class="item"><div class="breadcrumb"><a href="/LunaRGod/categories/%E6%B8%97%E9%80%8F%E9%9D%B6%E5%9C%BAWP/" title="分类于 渗透靶场WP">渗透靶场WP</a></div><span><a href="/LunaRGod/2024/07/15/%E7%BA%A2%E6%97%A5%E5%AE%89%E5%85%A8vulnstack%20(%E4%B8%80)/" title="红日安全vulnstack (一)">红日安全vulnstack (一)</a></span></li><li class="item"><div class="breadcrumb"><a href="/LunaRGod/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/" title="分类于 漏洞复现">漏洞复现</a></div><span><a href="/LunaRGod/2023/03/29/Strust2RCE/" title="S2-001 RCE">S2-001 RCE</a></span></li><li class="item"><div class="breadcrumb"><a href="/LunaRGod/categories/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E4%BB%A3%E7%90%86/" title="分类于 内网隧道代理">内网隧道代理</a></div><span><a href="/LunaRGod/2024/05/03/SMB%E5%8F%8D%E5%90%91%E8%BF%9E%E6%8E%A5%E9%9A%A7%E9%81%93%20%E9%98%B2%E7%81%AB%E5%A2%99%E6%9B%BF%E6%8D%A2/" title="SMB反向连接隧道 &amp; 防火墙替换">SMB反向连接隧道 & 防火墙替换</a></span></li><li class="item"><div class="breadcrumb"><a href="/LunaRGod/categories/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E4%BB%A3%E7%90%86/" title="分类于 内网隧道代理">内网隧道代理</a></div><span><a href="/LunaRGod/2024/05/15/%E4%BB%A3%E7%90%86%E8%BD%AF%E4%BB%B6%E6%8A%80%E6%9C%AF-%20%20CS-MSF%E4%BB%A3%E7%90%86%E8%B7%B3%E6%9D%BF/" title="代理软件 &amp; CS&#x2F;MSF代理跳板">代理软件 & CS/MSF代理跳板</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/LunaRGod/2023/05/01/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" title="Java--多线程">Java--多线程</a></span></li><li class="item"><div class="breadcrumb"><a href="/LunaRGod/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" title="分类于 网络安全">网络安全</a></div><span><a href="/LunaRGod/2024/03/29/JS%E9%80%86%E5%90%91-%E6%9E%84%E9%80%A0/" title="JSFuzz-逆向构造数据包">JSFuzz-逆向构造数据包</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2023 – <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">月 @ SABER</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<a href="https://github.com/amehime/hexo-theme-shoka">Shoka</a></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2024/05/19/云安全攻防/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/LunaRGod/js/app.js?v=0.2.5"></script></body></html>