<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="月" href="https://lunargod.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="月" href="https://lunargod.github.io/atom.xml"><link rel="alternate" type="application/json" title="月" href="https://lunargod.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="java,git,springcloud"><link rel="canonical" href="https://lunargod.github.io/2024/03/29/JS%E9%80%86%E5%90%91/"><title>JSFuzz-逆向构造数据包 - 网络安全 | LunaRGFod = 月 = HelloWord</title><meta name="generator" content="Hexo 7.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">JSFuzz-逆向构造数据包</h1><div class="meta"><span class="item" title="创建时间：2024-03-29 22:09:49"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2024-03-29T22:09:49+08:00">2024-03-29</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>11k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>10 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">LunaRGFod</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://pic.imgdb.cn/item/673a9b7bd29ded1a8c291fcb.jpg"></li><li class="item" data-background-image="https://pic.imgdb.cn/item/67384d09d29ded1a8c7b5428.jpg"></li><li class="item" data-background-image="https://pic.imgdb.cn/item/673845eed29ded1a8c74e1a6.jpg"></li><li class="item" data-background-image="https://pic.imgdb.cn/item/67384617d29ded1a8c7501d9.png"></li><li class="item" data-background-image="https://pic.imgdb.cn/item/67371d04d29ded1a8c8c8a94.jpg"></li><li class="item" data-background-image="https://pic.imgdb.cn/item/673a08fdd29ded1a8cd2e19b.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" itemprop="item" rel="index" title="分类于 网络安全"><span itemprop="name">网络安全</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://lunargod.github.io/2024/03/29/JS%E9%80%86%E5%90%91/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="月"><meta itemprop="description" content="HelloWord, 你越安静 你听到的就越多"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="月"></span><div class="body md" itemprop="articleBody"><p><img data-src="https://pic.imgdb.cn/item/67371d61d29ded1a8c8cfd08.jpg" alt></p><p><strong>前置思路文章</strong></p><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvdmxVSU45RWI2cHFoVXdoMUNvajBRZw==">JS 逆向混淆前端对抗</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvbFN5Uk85bWZNSllnYW56Zzd4Wnczdw==">油猴 JS 逆向插件</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvdFVGektTWXMzaGtheTdMUmlVak5Gdw==">JS 加解密之 mitmproxy 工具联动 Burp</span></p><h1 id="js挖掘基础"><a class="anchor" href="#js挖掘基础">#</a> JS 挖掘基础</h1><h2 id="伪协议"><a class="anchor" href="#伪协议">#</a> 伪协议</h2><p><code>JavaScript</code> 伪协议是一种在浏览器中模拟网络请求的方法。它使用 <code>window.XMLHttpRequest</code> 对象或 <code>fetch()</code> 方法来模拟发送 HTTP 请求，而不是通过实际的网络请求来获取数据。</p><p>例如，以下代码使用 <code>fetch()</code> 方法模拟发送一个 GET 请求到 <code>example.com</code> ，并处理返回的数据</p><p></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">fetch</span>(<span class="string">&#x27;https://example.com&#x27;</span>)</span><br><span class="line"> .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> response.<span class="title function_">text</span>())</span><br><span class="line"> .<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(data));</span><br></pre></td></tr></table></figure><p></p><p>在这个例子中，我们使用 <code>fetch()</code> 方法发送一个 GET 请求到 <code>https://example.com</code> ，然后使用 <code>.text()</code> 方法获取响应的文本内容，最后使用 <code>console.log()</code> 方法将响应的内容输出到控制台。</p><p>需要注意的是，虽然使用 JavaScript 伪协议可以模拟网络请求，但它并不能完全取代实际的网络请求，因为它的性能和可靠性都比实际的网络请求要差。此外，使用 JavaScript 伪协议可能会导致一些安全问题，因为它可以被恶意代码利用来获取敏感信息</p><h2 id="xss利用js变量提升"><a class="anchor" href="#xss利用js变量提升">#</a> <code>XSS</code> 利用 JS 变量提升</h2><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvYW5peFFyTzFRTWgwQzNlTzZWOF9XQQ==">XSS 案例</span></p><p>JavaScript 中的变量提升是指在代码执行过程中，JavaScript 引擎会将变量声明提升到其作用域的顶部，但不会提升变量的赋值。这意味着您可以在变量声明之前访问变量，但变量的值将是 <code>undefined</code></p><hr><p><code>undefinedVar</code> 是个未命名的变量，如果我们直接使用的话会被变量未定义错误。但是如果我们在下面再次去使用这个变量并且去声明它赋值，那么上面的就不会报错了</p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_IbVdo16p62.png"></p><p>下方代码前者是未定义就使用的，但下面还是正常的去声明使用了，整体并没有报错出现，这是因为变量提升的原因，把 <code>var</code> <code>undefinedVar</code> 提升到了顶部，最开头 所以往下的 <code>undefinedVar = null</code> 并不会报错</p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_17gcM-BdtG.png"></p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_Q7SCLIkslt.png"></p><h2 id="f12控制台参数"><a class="anchor" href="#f12控制台参数">#</a> F12 控制台参数</h2><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjE2NDc3MC9hcnRpY2xlL2RldGFpbHMvMTI0OTUwNDE2">F12 查看接口出参入参</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI3MDA5MjI1L2FydGljbGUvZGV0YWlscy8xMDc1NjcxMzM=">F12 数据包接口信息</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvSVNUdkpwMEo2ZXoxYXpCQ0IzN0hjUQ==">Fkalis 文章接口测试</span></p><h3 id="获取接口信息"><a class="anchor" href="#获取接口信息">#</a> 获取接口信息</h3><p><code>F12</code> 打开控制台下方就是整体的数据，包括选择的接口，以 <code>Edge</code> 为例在网络选项中打开此页面，如果对响应头或者是请求头不明白直接 <code>ChatGPT</code> 审计就是</p><p><strong>Fetch/XHR :</strong></p><blockquote><p>这个功能可以帮助开发人员分析和调试网络请求，包括请求的 URL、请求方法、请求头、请求体、响应状态码、响应头、响应体等信息。通过查看 Fetch/XHR 选项中的请求和响应信息，开发人员可以快速定位网络请求的问题，例如请求失败、响应慢、响应数据异常等，其实也就是一个筛选器，<br>选项右边我们还可以只查看 CSS JS 这些</p></blockquote><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_ZL7dktQHa9.png"></p><p>测试中接口地址响应后返回了相关的数据，那么我们就可以尝试对这个 <code>/ums/ums/getRole</code> 接口的 <code>getRole</code> 参数进行 Fuzz</p><p>观察数据包的请求和响应就可以确定这个接口获取请求是否存在漏洞</p><p><strong>数据包:</strong></p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POST /ums/ums/getRole HTTP/<span class="number">1.1</span></span><br><span class="line">Host: user.xxxxxxx.sjtu.edu.cn</span><br><span class="line">Accept: application/json, text/plain, *<span class="comment">/*</span></span><br><span class="line"><span class="comment">Accept-Encoding: gzip, deflate, br</span></span><br><span class="line"><span class="comment">Accept-Language: zh-CN,zh;q=0.9</span></span><br><span class="line"><span class="comment">Content-Length: 0</span></span><br><span class="line"><span class="comment">Origin: https://user.xxxxxxx.sjtu.edu.cn</span></span><br><span class="line"><span class="comment">Referer: https://user.xxxxxxx.sjtu.edu.cn/ums/user/index.html</span></span><br><span class="line"><span class="comment">Sec-Fetch-Dest: empty</span></span><br><span class="line"><span class="comment">Sec-Fetch-Mode: cors</span></span><br><span class="line"><span class="comment">Sec-Fetch-Site: same-origin</span></span><br><span class="line"><span class="comment">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36</span></span><br><span class="line"><span class="comment">sec-ch-ua: &quot;Chromium&quot;;v=&quot;112&quot;, &quot;Google Chrome&quot;;v=&quot;112&quot;, &quot;Not:A-Brand&quot;;v=&quot;99&quot;</span></span><br><span class="line"><span class="comment">sec-ch-ua-mobile: ?0</span></span><br><span class="line"><span class="comment">sec-ch-ua-platform: &quot;macOS&quot;</span></span><br></pre></td></tr></table></figure><p></p><p><strong>响应包:</strong></p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">HTTP/<span class="number">1.1</span> <span class="number">200</span> OK</span><br><span class="line">Access-Control-Allow-Credentials: <span class="literal">true</span></span><br><span class="line">Access-Control-Allow-Credentials: <span class="literal">false</span></span><br><span class="line">Access-Control-Allow-Headers: X-Requested-With,Content-Type</span><br><span class="line">Access-Control-Allow-Methods: PUT,POST,GET,DELETE,OPTIONS</span><br><span class="line">Access-Control-Allow-Origin: https:<span class="comment">//user.xxxxxxx.sjtu.edu.cn</span></span><br><span class="line">Connection: keep-alive</span><br><span class="line">Content-Type: application/json; charset=utf-<span class="number">8</span></span><br><span class="line">Date: Tue, <span class="number">07</span> Feb <span class="number">2023</span> <span class="number">10</span>:<span class="number">40</span>:<span class="number">42</span> GMT</span><br><span class="line">Etag: W/<span class="string">&quot;4d4-d17bqK52VNY2JQ4ODTzgbhOimVQ&quot;</span></span><br><span class="line">Server: nginx</span><br><span class="line">Strict-Transport-Security: max-age=<span class="number">31536000</span>; includeSubDomains</span><br><span class="line">X-Content-Type-Options: nosniff</span><br><span class="line">X-Frame-Options: SAMEORIGIN</span><br><span class="line">X-Nginx-Debug-Variables: host:user.xxxxxxx.sjtu.edu.cn,request_uri:/ums/ums/getRole,</span><br><span class="line">X-Powered-By: Express</span><br><span class="line">X-Xss-Protection: <span class="number">1</span>; mode=block</span><br><span class="line">Content-Length: <span class="number">2721</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;code&quot;</span>: <span class="number">100</span>,</span><br><span class="line">    <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;请求成功&quot;</span>,</span><br><span class="line">    <span class="string">&quot;extend&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;returnMsg&quot;</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">&quot;roleId&quot;</span>: <span class="string">&quot;10&quot;</span>,</span><br><span class="line">                <span class="string">&quot;name&quot;</span>: <span class="string">&quot;用户联络员&quot;</span>,</span><br><span class="line">                <span class="string">&quot;energyValid&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">                <span class="string">&quot;imsValid&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">                <span class="string">&quot;meetingValid&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">                <span class="string">&quot;visitorValid&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">                <span class="string">&quot;limsValid&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">                <span class="string">&quot;param01&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="string">&quot;param02&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">                <span class="string">&quot;param03&quot;</span>: <span class="string">&quot;3&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">&quot;roleId&quot;</span>: <span class="string">&quot;11&quot;</span>,</span><br><span class="line">                <span class="string">&quot;name&quot;</span>: <span class="string">&quot;运行管理员&quot;</span>,</span><br><span class="line">                <span class="string">&quot;energyValid&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">                <span class="string">&quot;imsValid&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">                <span class="string">&quot;meetingValid&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">                <span class="string">&quot;visitorValid&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">                <span class="string">&quot;limsValid&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">                <span class="string">&quot;param01&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="string">&quot;param02&quot;</span>: <span class="string">&quot;2&quot;</span>,</span><br><span class="line">                <span class="string">&quot;param03&quot;</span>: <span class="string">&quot;1&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">&quot;roleId&quot;</span>: <span class="string">&quot;13&quot;</span>,</span><br><span class="line">                <span class="string">&quot;name&quot;</span>: <span class="string">&quot;系统管理员&quot;</span>,</span><br><span class="line">                <span class="string">&quot;energyValid&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">                <span class="string">&quot;imsValid&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">                <span class="string">&quot;meetingValid&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">                <span class="string">&quot;visitorValid&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">                <span class="string">&quot;limsValid&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">                <span class="string">&quot;param01&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="string">&quot;param02&quot;</span>: <span class="string">&quot;3&quot;</span>,</span><br><span class="line">                <span class="string">&quot;param03&quot;</span>: <span class="string">&quot;1&quot;</span></span><br><span class="line">            &#125;,</span><br></pre></td></tr></table></figure><p></p><p>请求标头可以获取到 Cookie</p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_Pvdshk1AQg.png"></p><h3 id="查看入参"><a class="anchor" href="#查看入参">#</a> 查看入参</h3><p>请求就是入参 响应就是出参，这里的入参格式有 key-value 格式也有 json 格式</p><p>关于二者区别</p><blockquote><p>它们的区别在于数据的组织方式和传输效率</p><p><code>Key-value</code> 形式的数据是一种简单的数据组织方式，它由一系列键值对组成，每个键值对之间用特定的分隔符分隔。这种数据格式通常用于传输简单的数据，例如表单数据、查询参数等。Key-value 形式的数据传输效率较高，因为数据量较小，传输速度较快</p><p><code>JSON</code> 格式的数据是一种轻量级的数据交换格式，它由一组键值对或数组组成，可以嵌套使用。JSON 格式的数据通常用于传输复杂的数据结构，例如对象、数组等。JSON 格式的数据传输效率较低，因为数据量较大，传输速度较慢。但 JSON 格式的数据具有良好的可读性和可扩展性，可以方便地进行解析和处理</p><p><strong>选择何种数据格式取决于具体的应用场景和数据传输需求。如果需要传输简单的数据，可以选择 key-value 形式的数据；如果需要传输复杂的数据结构，可以选择 JSON 格式的数据</strong></p></blockquote><p>在负载这里看到查询字符串参数，<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup> 就是入参数据并且可以查看请求源，它是拼接后的数据 下方拼接后为</p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">positionId=<span class="number">644</span>&amp;queryWord=&amp;articleId=<span class="number">0</span>&amp;adId=<span class="number">5518</span></span><br></pre></td></tr></table></figure><p></p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_n0jm-Aiy7q.png"></p><h3 id="查看出参"><a class="anchor" href="#查看出参">#</a> 查看出参</h3><p>响应页面看出参数据..</p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_OnooIIjqDQ.png"></p><h3 id="查看cookie数据格式"><a class="anchor" href="#查看cookie数据格式">#</a> 查看 Cookie 数据格式</h3><p>选择请求右侧 Cookie 它的组成其实就是一个个的 key 和 value</p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_2_7bkJfT3F.png"></p><h1 id="js审计"><a class="anchor" href="#js审计">#</a> JS 审计</h1><p><code>JS</code> 文件可以看是否存在版本或者名称信息这样可以去网上找相关漏洞</p><h2 id="手动搜索参数"><a class="anchor" href="#手动搜索参数">#</a> 手动搜索参数</h2><p>控制台直接搜索这种 <code>api</code> 语句就可以找到不同的接口，获取到特殊的路径，获取其他的敏感字眼</p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Path</span><br><span class="line">GET</span><br><span class="line">POST</span><br><span class="line">url</span><br><span class="line">ajax</span><br><span class="line">onBoardTab</span><br><span class="line"></span><br><span class="line">config.js   <span class="comment">// 拼接全局配置文件</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p></p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/4d5047c11320438e0b481290e5ea9db0_pFKODMBXaj.png"></p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_HlK5IdwMOc.png"></p><p>找到的是隐藏的接口 类似 <code>api/login/name</code> 拼接到主站域名中，普通的路由也就网站的路径，接口指后端中的函数，调用接口等于调用了后端某个函数功能实现增删改查等等</p><p></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">网站路径 = url = 目录 = 路由</span><br></pre></td></tr></table></figure><p></p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_vtVP-U0DM7.png"></p><p>如果拼接出来是空白的，就按照路径慢慢删掉，回到上级目录有的 <code>.net</code> 网站会有接口管理器，找到一个接口返回上级目录就可以看到所有接口，而且有的 <code>aspx</code> 接口是可以看到参数值的）</p><p></p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">baidu.com/api/login/name</span><br></pre></td></tr></table></figure><p></p><p>找到的是 <code>url</code> 在浏览器执行即可 一般会得到 <code>JSON</code> 格式的数据</p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_r6X2GL3-Xh.png"></p><p>类似这种路径下存在参数，可以路径带参数构造</p><blockquote><p><span class="exturl" data-url="aHR0cDovL3h4Lnh4Lnh4Lnh4Lw==">http://xx.xx.xx.xx</span> /<strong>commonServletfromflag=queryWorkUserBySectionId&amp;sectionId_search=1</strong></p></blockquote><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_SvexSDX3JM.png"></p><p>控制台查看了一下 <code>RPC</code> 函数的 <code>js</code> 源码，也算是一个审计 <code>js</code> 源码的小 <code>trick</code> ： <code>js</code> 函数名 +'' 会自动调用 <code>js</code> 函数对象的 <code>toString</code> 方法，从而输出对应的 js 函数的源码，避免了自己一步步从一堆源码里寻找这个函数</p><p></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">console.log(RPC+<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><p></p><h2 id="审计源码"><a class="anchor" href="#审计源码">#</a> 审计源码</h2><p>在控制台应用程序选项，拉到底部可以在这里看到这个页面所有的 <code>JS脚本</code> ，一般 <code>JS</code> 文件通常会 <code>报出 CMS版本</code> ，和一些 <code>验证判断响应值</code> 有了 CMS 可以尝试去网上找通杀 Nday 攻击，并且还有有其他注释没有来的及删除的信息，渗透测试的本质就是信息收集</p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_xvtMDyagru.png"></p><blockquote><p>在挖掘时别人能挖掘出水平越权垂直越权，是因为这个越权漏洞的传参值都是在接口中进行的，所以我们要在挖掘的时候利用<strong> Burp</strong> 抓住每一个包<br>然后再去看 <code>Burp</code> 里面的 <code>http</code> 历史记录 查看接口信息</p><p><code>Webpack</code> 会包含很多接口信息</p></blockquote><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_Uyy-bR7kUY.png"></p><p>如果在站点页面是无法看见？id 这个参数的，而你在<strong> burp 历史包中即可以看见此参数，这个参数就是个人身份的参数</strong></p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_3OBWiyj7JB.png"></p><p>接使用浏览器的控制台中的网络即可查找，重发刷新页面就会再进行一次请求，如果再下方找到隐藏的身份参数后，讲 uid=xxx 修改为别人的数值 即是测试越权</p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_qlNEOJiM1C.png"></p><h2 id="python解决js加密"><a class="anchor" href="#python解决js加密">#</a> Python 解决 JS 加密</h2><p>逆向出参数是由什么加密而来的，首尾加入了什么固定的字符串，加密几个参数就写一个方法解密出这些参数</p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_W23U62xeqW.png"></p><p></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> execjs</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;&quot;</span>,r) <span class="keyword">as</span>  f   // 引入函数</span><br><span class="line">    a = execjs.<span class="built_in">compile</span>(f.read()) </span><br><span class="line">    result1 =a.call(<span class="string">&quot;md5&quot;</span>,<span class="string">&quot;&quot;</span>)  // 对应函数 md5是函数名 后面是形参</span><br><span class="line">    <span class="built_in">print</span>(result1)</span><br></pre></td></tr></table></figure><p></p><p><code>passwd</code> 是 保存明文密码的文件</p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/2222_LcFMHaAxl3.png"></p><h2 id="反编译jsmap"><a class="anchor" href="#反编译jsmap">#</a> 反编译 <code>js.map</code> <sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup></h2><p>反编译<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzYwODE3L2FydGljbGUvZGV0YWlscy8xMzQ5Nzc3NzU="> Webpakc js.map</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvcWN3RV9QUmVuNWpyN0NSQnVpS1Z2dw==">提取 WebPack 打包站点接口</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3Mvb2hremRMclFEclNxZHdpazRyNXlsdw==">JSFuzz 接口导致铭感信息泄露</span></p><p><code>Vue</code> 使用 <code>webpack</code> (静态资源打包器) 的时候，如果未进行正确配置，会产生一个 <code>js.map</code> 文件，而这个 <code>js.map</code> 可以通过工具来反编译还原 <code>Vue</code> 源代码，产生代码泄露，并且前后端分析网站前端使用 <code>Vue</code> 重点找 <code>xxx.app.js</code> 再从中提取新的接口</p><p></p><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reverse-sourcemap --output-dir . xxx.js.map</span><br></pre></td></tr></table></figure><p></p><h1 id="数据包接口构造"><a class="anchor" href="#数据包接口构造">#</a> 数据包接口构造</h1><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvbGJtYU1Ja2xoUURYdElrTXdJaXJldw==">前端 JavaScript 渗透测试步步为营</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvaU11NHY1cDFVOVFpbks1aTNZMkh1dw==">JSFuzz 接口实现 SSRF</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvaGtES3VBcy1kUm5wdVVkQXIwdFcyQQ==">JS 更换请求方式构造</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3Mvb2hremRMclFEclNxZHdpazRyNXlsdw==">JSFuzz 接口导致铭感信息泄露</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvdE43YmkwZ3lidE5OdVVfRzFneUJSUQ==">JS 拼接杂谈</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvcU1fRXVTZ0RHWGhlWHd5UU9IbU1ydw==">fkalis 关于 JS 研究</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL21wL2FwcG1zZ2FsYnVtP19fYml6PU16a3pOVFV3TlRnMk5nPT0mYW1wO2FjdGlvbj1nZXRhbGJ1bSZhbXA7YWxidW1faWQ9MzYxMjY2NjYxNzc1MjA1OTkxNyZhbXA7c2NlbmU9MTczJmFtcDtzdWJzY2VuZT0mYW1wO3Nlc3Npb25pZD1zdnJfMmMwNDJmZWQzN2QmYW1wO2VudGVyaWQ9MTcyODg3ODE1OCZhbXA7ZnJvbV9tc2dpZD0yMjQ3NDgzNzU0JmFtcDtmcm9tX2l0ZW1pZHg9MSZhbXA7Y291bnQ9MyZhbXA7bm9sYXN0cmVhZD0xI3dlY2hhdF9yZWRpcmVjdA==">JS 接口系列文章</span></p><h2 id="fuzz前置目录"><a class="anchor" href="#fuzz前置目录">#</a> Fuzz 前置目录</h2><p><code>JS</code> 找到的接口某些情况下不能直接访问，前置或者还有一层目录，这个就需要我们去进行 <code>fuzz</code> 或者信息收集寻找接口间的共性再进行爆破，直接的话只能使用字典，我建议先找个登录点抓个包看看路径是否有一个基路径（一级目录），然后再拼接跑一遍。</p><p></p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/data/teach/hr/search?key= <span class="comment">// 可疑接口,后面带入参数可疑搜索更多</span></span><br><span class="line"></span><br><span class="line">/data/teach/hr/search?key=<span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">roleid  <span class="comment">// 角色ID</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p></p><h2 id="构造接口"><a class="anchor" href="#构造接口">#</a> 构造接口</h2><p>其实很好理解，如果网站功能点只能允许查看 <code>info</code> 那么在查询接口功能抓包，构造参数为删除 <code>delete</code> , 接口有的是主动构造有的是工具熊猫头或其他审计得到的接口，整理后 <code>GET</code> <code>POS</code> 方法访问</p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">api/info?id=<span class="number">1</span>   <span class="comment">// 正常查询接口</span></span><br><span class="line"></span><br><span class="line">api/delete?id=<span class="number">1</span>  <span class="comment">//   构造删除接口 </span></span><br><span class="line"></span><br><span class="line">/api/v1/api-docs <span class="comment">//  尝试/api/v2/api-docs  /api/v3/api-docs</span></span><br><span class="line"></span><br><span class="line">------------------------------------------------------</span><br><span class="line"></span><br><span class="line">前置接口</span><br><span class="line"></span><br><span class="line">/user/saber 无法直接访问</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> api /user/saber/  fuzz前置接口,递归扫描重要性就出现了</span><br></pre></td></tr></table></figure><p></p><p>常见业务接口格式如果 <code>js</code> 文件中只有查询的接口，那么自己可以尝试一下构造添加、修改和删除接口</p><p>多观察接口，推测其功能，然后根据功能去 FUZZ，毕竟你要实现一个 web 功能，基本都要有对应的增删改查接口</p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 后台的模块的接口格式</span></span><br><span class="line"></span><br><span class="line">OST /PUT  /api/模块名  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加</span></span><br><span class="line">POST /api/模块名/add   </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除接口</span></span><br><span class="line"></span><br><span class="line">DELETE /api/模块名/id </span><br><span class="line"> </span><br><span class="line">GET /api/模块名/del?id=</span><br><span class="line"></span><br><span class="line">POST /api/模块名/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改接口</span></span><br><span class="line"></span><br><span class="line">POST /api/模块名/modify</span><br><span class="line"></span><br><span class="line">POST /api/模块名/</span><br><span class="line"></span><br><span class="line"><span class="comment">// 查询接口</span></span><br><span class="line"></span><br><span class="line">GET /api/模块名/list</span><br><span class="line"></span><br><span class="line">/api/模块名/all</span><br><span class="line"></span><br></pre></td></tr></table></figure><p></p><p></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">查询（获取信息）</span><br><span class="line">search list select query get find</span><br><span class="line"></span><br><span class="line">删除（删除某个数据）</span><br><span class="line">del Delete</span><br><span class="line"></span><br><span class="line">编辑（更新某个信息）</span><br><span class="line">Update Up edit Change</span><br><span class="line"></span><br><span class="line">添加（增加某个信息）</span><br><span class="line">add create new</span><br></pre></td></tr></table></figure><p></p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_zfmdmgQ2HA.png"></p><h2 id="构造参数"><a class="anchor" href="#构造参数">#</a> 构造参数</h2><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvaVZVRXIzY1luRmQ4RXdJdkdkZ3plUQ==">JS 寻找关键参数</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvTDlhM1lzZVVYZHhzMUxJMzNCU1gyUQ==">应该如何寻找参数的蛛丝马迹</span></p><p>无论是熊猫头还是其他工具得到的接口其实是不完整的，直接拼接的话缺少参数是无法访问接口会报错，需要构造 ** 参数，** 如果我们直接去 <code>fuzz</code> 猜参数，那基本上是属于大海捞针，几乎不太可能成功。那这时候就需要去 <code>JS</code> 源码里面找一下它的调用代码，看看它是怎么请求的，都有什么参数</p><p><code>GET</code> 请求参数拼接到链接中， <code>POST</code> 请求构造参数拼接到下方 <code>Body</code></p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_NrpsHz7yJs.png"></p><h2 id="构造js文件"><a class="anchor" href="#构造js文件">#</a> 构造 JS 文件</h2><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvQW9FTGdFaV9nOEpmQWxVUGY2WmltQQ==">实战某金融 SRC 通过 JS 接口进入后台</span></p><p>当接口参数无法操作，信息收集只要少量 <code>JS</code> 文件既可以使用爆破模块对 <code>JS</code> 进行 <code>fuzz</code> 如果响应了新的文件再从响应包中审计新的接口，案例见标题</p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_dIz0K9dxfd.png"></p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_johI4m_WxV.png"></p><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvN0g1Y1hCOUF0ZUE2bERUOVc3bGoyUQ==">实战</span><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvN0g1Y1hCOUF0ZUE2bERUOVc3bGoyUQ=="> FuzzJS</span><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvN0g1Y1hCOUF0ZUE2bERUOVc3bGoyUQ=="> 文件</span></p><p>文章展示了针对古老的站点测试手段，野战和 <code>edu</code> 测试功能点无从下手的时候可以回来看看这篇文章看看有没有启发 <code>PHP/ASP.NET</code> <code>fuzzjs</code> 可以利用 <code>BP</code> 配合字典直接开测，观察响应接口 文章推荐了 <code>FFUF</code> 工具操作 对与 <code>403</code> 页面尝试绕过和 <code>dr</code> 工具爆破</p><h2 id="fuzz爆破接口路径"><a class="anchor" href="#fuzz爆破接口路径">#</a> <code>Fuzz</code> 爆破 / 接口路径</h2><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvWWpYSFdWQS1QWHZVUXdVdnd0ckNCZw==">api 接口猜测爆破</span></p><p>观察抓取到的数据包的接口，寻找共同函数的特征，爆破后面的数字或许会有未授权访问的接口或者功能可以先猜目录再猜参数<strong>网站就一个文件夹存放了很多的文件</strong></p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/funtion123   </span><br><span class="line">/fun2334  </span><br><span class="line">/fun345</span><br></pre></td></tr></table></figure><p></p><p>响应包出现我们不知道参数，第一先去 <code>JS</code> 中全局找这个参数看看有没有相似的路径拼接构造，有就拼；无则 <code>fuzz</code></p><h1 id="js逆向"><a class="anchor" href="#js逆向">#</a> JS 逆向</h1><blockquote><p>逆向加密是为了应对数据包中出现 <code>sign</code> 或者 <code>token</code> 的情况， <code>sigh</code> 和对应的 <code>passwd</code> 字段关联，修改了 <code>passwd</code> 字段 <code>sign</code> 匹配不上就无法测试</p><p>所以 <code>sign</code> 的加密肯定会有 <code>passwd</code> 字段参与，找到加密 <code>sign</code> 的位置构造我们想要测试的 <code>passwd</code> 生成新的 <code>sign</code> 字段就是我们所测试生成的字段这样响应包就不会显示签名问题</p></blockquote><p><strong>小程序 F12</strong></p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//blog.csdn.net/u010062917/article/details/135649668  // 文章</span></span><br><span class="line"></span><br><span class="line">https:<span class="comment">//github.com/JaveleyQAQ/WeChatOpenDevTools-Python/   // 工具</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p></p><h2 id="定位加密参数方式"><a class="anchor" href="#定位加密参数方式">#</a> 定位加密参数方式</h2><p><strong>全局搜索</strong> ** <code>password</code> **</p><p>根据网络请求已经发现了加密字段 <code>password</code> 全局搜索即可，或是全局搜索 <code>encrypt</code> 函数一般加密前缀都是此名称，利用搜分析其实非常快速</p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(<span class="number">1</span>)复制加密参数的键名</span><br><span class="line"></span><br><span class="line">(<span class="number">2</span>)Ctrl + Shift + F 键快捷通过search搜索该键名定位js加密文件,对出现字段位置打入断点                </span><br><span class="line"></span><br><span class="line">(<span class="number">3</span>)在几个JS函数后打上断点, 然后点击执行或者刷新网页,通过断点停止和参数信息判断如何加密的,如果在里面看到关键加密方式</span><br><span class="line">     就说明这很大几率是加密过程</span><br><span class="line">     </span><br><span class="line">(<span class="number">4</span>)通过一步一步断点,分析加密参数是如何产生的</span><br><span class="line"></span><br><span class="line">(<span class="number">5</span>)定位到最初加密字段位置 复现算法</span><br></pre></td></tr></table></figure><p></p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_KhWKk_Uylh.png"></p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_FrqSVzVcTL.png"></p><p>** <code>XHR</code> **<strong> 定位</strong></p><p>同样定位到加密字段的请求，请求路径即可，不需要携带参数，针对普通的跟栈找不到 <code>data</code> 数据情况</p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/login.php</span><br></pre></td></tr></table></figure><p></p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_KhWKk_Uylh.png"></p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_BgZBl9sg5C.png"></p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_bymhgA90Q3.png"></p><p>输入对应的请求路径后再次点击登录就会定位到我们所选择的堆栈函数</p><p><a href="video/QQ2024616-14257-HD_QQtzvBzTcu.mp4">QQ2024616-14257-HD.mp4</a></p><p><strong>跟随堆栈定位</strong></p><p>爱拍案例就是此方法，跟进每个函数后还可以在此函数的 <code>JS</code> 里面全局搜索加密字段，因为断点位置可能并无加密方法，也可能是在上下文</p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_GtRh6LO3BH.png"></p><h2 id="爱拍案例-md5"><a class="anchor" href="#爱拍案例-md5">#</a> 爱拍案例 MD5</h2><blockquote><p>定位出加密的函数有两种方式，1 是定向的找字段，2 是根据请求跟请求调用栈，第一种全局搜索加密参数 但是试用于搜索出来值很少 十个以内就可以利用搜的方法，这里还是选择跟踪加密数据包堆栈函数</p></blockquote><h3 id="0x01-堆栈寻找加密函数"><a class="anchor" href="#0x01-堆栈寻找加密函数">#</a> 0X01 堆栈寻找加密函数</h3><p>进入网站打开网络，任意输入账户密码，在网络中找到关键的请求里面是对应加密过后的账户密码 <code>password</code> 并且要把保留日志和停用缓存勾选，对应关键请求查找就是看哪个存在加密就跟哪个函数</p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_0IfGsNB_q8.png"></p><p>选择启动器查看堆栈函数，从下往上执行结束，我就从结束的点往下选择加密位置</p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_8ledvY-IPG.png"></p><p>跟入堆栈打入断点并放掉余下的包，余下还有其他的待执行的脚本包，类似于 <code>BP</code> 拦截，所以要全部放掉，之后再次点击登录发出新的包，不然的话包是不一样的</p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_TSPHdMDbGK.png"></p><p><a href="video/QQ2024616-14055-HD_umFLWGijov.mp4">QQ2024616-14055-HD.mp4</a></p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_hnVvUYUimN.png"></p><p>断点完成最新的堆栈出现，开始一个个往下跟寻找加密位置，找到未加密前的函数，找到的是加密后的函数就直接放弃进入下一个，直到未加密位置</p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">函数名称如果是JQ库或是其他语义化比较明显的js就直接跳过因为这种加密都是现成的并没有算法</span><br></pre></td></tr></table></figure><p></p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_tJbg6uZMls.png"></p><p>一个个移动堆栈直到找到对应的加密算法，为 <code>md5</code></p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">e.md5(q)  q=<span class="number">123456</span> <span class="comment">// 明文</span></span><br></pre></td></tr></table></figure><p></p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_6LddFGf1Id.png"></p><p>控制台也可以验证此函数打印后的值就是就加密后的值 并和 <code>BP</code> 值一致</p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_gU52CLNqal.png"></p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_an6wOeb9FF.png"></p><p>控制台控制 <code>q</code> 的值并再使用算法可以生成新的值，试用于手动的进行替换，这样加密参数就为我们所控</p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image__EjLMi46kt.png"></p><h3 id="0x02-跟入函数内部"><a class="anchor" href="#0x02-跟入函数内部">#</a> 0X02 跟入函数内部</h3><p>确定好加密算法位置，然后对此打入断点并放掉所有的脚本重新点击登录数据就会卡在此处，如果先前有断点也要清除只保留这一处断点即可</p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_PBt6YPPY9U.png"></p><p>使用浏览器堆栈工具跟入加密 <code>md5</code> 函数内部并返回，确定了是 <code>md5</code> 加密方式 并返回上一步函数，测试了忽略断点工具使用</p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_2eJ_vKDLSm.png"></p><p><a href="video/QQ2024616-05632-HD_UAVaNnJhwN.mp4">QQ2024616-05632-HD.mp4</a></p><p><code>md5</code> 算法</p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image__3tEs9LGlz.png"></p><h3 id="0x03-工具生成算法"><a class="anchor" href="#0x03-工具生成算法">#</a> 0X03 工具生成算法</h3><p>跟踪到加密算法后虽然可以在控制台手动的去将加密函数执行并手动替换，但是还是脚本来的快速，打开 <code>WT-JS</code> 选择原生的加解密库 <code>CryptoJS</code> 选择加密方式为 <code>md5</code></p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_BNValdkklH.png"></p><p>生成加密本地的加密算法</p><p><a href="video/QQ2024616-1335-HD_hzNmvzqT99.mp4">QQ2024616-1335-HD.mp4</a></p><p>加入打印方法调用加密的函数，得出我们所需的加密值</p><p></p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MD5加密执行</span></span><br><span class="line"></span><br><span class="line">console.<span class="built_in">log</span>(<span class="built_in">MD5_Encrypt</span>(<span class="string">&quot;123456&#x27;&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行js脚本</span></span><br><span class="line"></span><br><span class="line"> node .\demo.js </span><br><span class="line"></span><br></pre></td></tr></table></figure><p></p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_Z_Kx5qKFF8.png"></p><h2 id="快乐学堂-des"><a class="anchor" href="#快乐学堂-des">#</a> 快乐学堂 DES</h2><p>前期根据加密请求跟栈找到密码加密位置，在 <code>pass</code> 密码出打入新的断点并清除先前断点，再点击登录，就会在密码卡住，明文被 <code>encryptByDES</code> 函数所加密，从名称上是 <code>DES</code> 对称加密需要寻找函数中的 <code>key</code></p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pass: encryptByDES(s) </span><br></pre></td></tr></table></figure><p></p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_lPs7WQGni2.png"></p><p>使用右侧工具跟进此函数内部</p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_JoOvVExKRc.png"></p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_uuu2EGUiUU.png"></p><p>发现此加密函数逻辑并出现 <code>Key</code> 打开 <code>WT</code> 工具进行复现写入对应设置生成加密算法</p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义密钥和初始化向量</span></span><br><span class="line"><span class="type">var</span> <span class="variable">_key</span> <span class="operator">=</span> <span class="string">&#x27;k1fsa01v&#x27;</span>; <span class="comment">// DES 加密所使用的密钥</span></span><br><span class="line"><span class="type">var</span> <span class="variable">_iv</span> <span class="operator">=</span> <span class="string">&#x27;k1fsa01v&#x27;</span>;  <span class="comment">// DES 加密的初始化向量，ECB 模式下无需使用，但在代码中仍然提供了</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// DES 加密函数</span></span><br><span class="line">function <span class="title function_">encryptByDES</span><span class="params">(message)</span> &#123;</span><br><span class="line">    <span class="comment">// 将密钥转换为 UTF-8 格式的字符数组</span></span><br><span class="line">    <span class="type">var</span> <span class="variable">keyHex</span> <span class="operator">=</span> CryptoJS.enc.Utf8.parse(_key);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用 CryptoJS 库进行 DES 加密</span></span><br><span class="line">    <span class="type">var</span> <span class="variable">encrypted</span> <span class="operator">=</span> CryptoJS.DES.encrypt(message, keyHex, &#123;</span><br><span class="line">        iv: CryptoJS.enc.Utf8.parse(_iv),  <span class="comment">// 指定初始化向量，ECB 模式下可以不使用</span></span><br><span class="line">        mode: CryptoJS.mode.ECB,          <span class="comment">// 指定加密模式为 ECB（电子密码本模式）</span></span><br><span class="line">        padding: CryptoJS.pad.Pkcs7       <span class="comment">// 指定填充方式为 PKCS7 填充</span></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 返回加密后的消息字符串</span></span><br><span class="line">    <span class="keyword">return</span> encrypted.toString();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p></p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_kGWO01SB1M.png"></p><h2 id="翼龙贷-des"><a class="anchor" href="#翼龙贷-des">#</a> 翼龙贷 DES</h2><p>寻找关键的请求花费了一些时间，因为加密的 <code>pass</code> 并未在堆栈中显示，需要自行上下找才行，找到了就打入断点对此加密方法进行跟进测试，注意必须是断点打入到加密函数中才能进入如 <code>encrypt</code> 不然会进错</p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_C2Sekv3qUm.png"></p><p><a href="video/QQ2024616-233248-HD_3p_4H2zlBn.mp4">QQ2024616-233248-HD.mp4</a></p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">e = e9284d45-cf2a-<span class="number">4e46</span>-<span class="number">9367</span>-f122413ca6b0</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 CryptoJS 将字符串 e 转换为 UTF-8 格式的字符数组</span></span><br><span class="line"><span class="type">var</span> <span class="variable">a</span> <span class="operator">=</span> CryptoJS.enc.Utf8.parse(e);</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 使用 DES 加密方法对字符串 t 进行加密</span></span><br><span class="line">    <span class="type">var</span> <span class="variable">s</span> <span class="operator">=</span> CryptoJS.DES.encrypt(String(t), a, &#123;</span><br><span class="line">        mode: CryptoJS.mode.ECB,      <span class="comment">// 指定加密模式为 ECB（电子密码本模式）</span></span><br><span class="line">        padding: CryptoJS.pad.Pkcs7   <span class="comment">// 指定填充方式为 PKCS7 填充</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125; <span class="keyword">catch</span> (t) &#123;</span><br><span class="line">    <span class="comment">// 捕获可能的加密错误并输出到控制台</span></span><br><span class="line">    console.log(t);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回加密后的消息字符串</span></span><br><span class="line"><span class="keyword">return</span> s.toString();</span><br><span class="line"></span><br></pre></td></tr></table></figure><p></p><p>写入算法完成</p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_8hU9qnYXi1.png"></p><h2 id="sign-逆向"><a class="anchor" href="#sign-逆向">#</a> sign 逆向</h2><p><code>sign</code> 加密出的字段都是和当前正常的 <code>username</code> 和 <code>passwd</code> 有关，每个数据包参数对应签名，参数被修改 <code>sign</code> 签名失效无法测试</p><p></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">username=admin123&amp;&amp;passwd=<span class="number">000000</span>   == a</span><br><span class="line"></span><br><span class="line">sign=signMd5(a)  <span class="comment">// 加密字段</span></span><br></pre></td></tr></table></figure><p></p><h3 id="python生成sign原理"><a class="anchor" href="#python生成sign原理">#</a> Python 生成 sign 原理</h3><p>追踪到的 <code>sign</code> 生成逻辑，给到 <code>AI</code> 分析然后告诉它利用 <code>Python</code> 编写于 <code>Passwd</code> 和 <code>sign</code> 对应的爆破字典， <code>AI</code> 给出具体的生成代码，并会有关键的字典让你填写进去，除了一些固定的参数如版本号或者其他字段，最重要的就是需要生成 <code>sign</code> 的 <code>passwd</code> 字典</p><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_T2hSdYonlZ.png"></p><p></p><blockquote><p>之前一直不明白为什么可以一直反复的替换，原来是生成了对应的 <code>sign</code> 字典再来爆破替换的，每个生成的 <code>sign</code> 对应了我们固定修改的值，爆破多个字段记得 <code>Python</code> 生成的逻辑也不同，需要写入两个文件修改来爆破，但是一般是只修改一个字典的值，如密码或者固定的支付中的单号，最终只会产生一个 <code>sign.txt</code> 供替换，所以原字典需要自己准备也就是想要爆破的值</p></blockquote><p><img data-src="/2024/03/29/JS%E9%80%86%E5%90%91/image_5LgePz8NHM.png"></p><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>不同浏览器看入参的选项不同<br>goole : 标头拉到最下方可以看到 Query String Parameters 这个就是入参数据，<br>火狐：有效载荷页面和 Edge 类似 <a href="#fnref1" class="footnote-backref">↩︎</a></p></li><li id="fn2" class="footnote-item"><p>VUE 框架，重点找 xxx.app.js 即可 <a href="#fnref2" class="footnote-backref">↩︎</a></p></li></ol></section></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2024-11-18 11:42:53" itemprop="dateModified" datetime="2024-11-18T11:42:53+08:00">2024-11-18</time> </span><span id="2024/03/29/JS逆向/" class="item leancloud_visitors" data-flag-title="JSFuzz-逆向构造数据包" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>月 <i class="ic i-at"><em>@</em></i>月</li><li class="link"><strong>本文链接：</strong> <a href="https://lunargod.github.io/2024/03/29/JS%E9%80%86%E5%90%91/" title="JSFuzz-逆向构造数据包">https://lunargod.github.io/2024/03/29/JS逆向/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC96aC1DTg=="><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2024/02/19/%E5%8A%A0%E8%A7%A3%E5%AF%86/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;pic.imgdb.cn&#x2F;item&#x2F;67371c24d29ded1a8c8b65eb.jpg" title="加解密算法逆向密文"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 网络安全</span><h3>加解密算法逆向密文</h3></a></div><div class="item right"><a href="/2024/04/29/%E5%9F%9F%E9%98%B2%E7%81%AB%E5%A2%99/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;pic.imgdb.cn&#x2F;item&#x2F;673a091dd29ded1a8cd2fec3.jpg" title="域防火墙规则策略 &amp; 隧道代理区别"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 内网隧道代理</span><h3>域防火墙规则策略 & 隧道代理区别</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#js%E6%8C%96%E6%8E%98%E5%9F%BA%E7%A1%80"><span class="toc-number">1.</span> <span class="toc-text">JS 挖掘基础</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%AA%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.1.</span> <span class="toc-text">伪协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xss%E5%88%A9%E7%94%A8js%E5%8F%98%E9%87%8F%E6%8F%90%E5%8D%87"><span class="toc-number">1.2.</span> <span class="toc-text">XSS 利用 JS 变量提升</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#f12%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%82%E6%95%B0"><span class="toc-number">1.3.</span> <span class="toc-text">F12 控制台参数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%8E%A5%E5%8F%A3%E4%BF%A1%E6%81%AF"><span class="toc-number">1.3.1.</span> <span class="toc-text">获取接口信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E5%85%A5%E5%8F%82"><span class="toc-number">1.3.2.</span> <span class="toc-text">查看入参</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E5%87%BA%E5%8F%82"><span class="toc-number">1.3.3.</span> <span class="toc-text">查看出参</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8Bcookie%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.3.4.</span> <span class="toc-text">查看 Cookie 数据格式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#js%E5%AE%A1%E8%AE%A1"><span class="toc-number">2.</span> <span class="toc-text">JS 审计</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%90%9C%E7%B4%A2%E5%8F%82%E6%95%B0"><span class="toc-number">2.1.</span> <span class="toc-text">手动搜索参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%A1%E8%AE%A1%E6%BA%90%E7%A0%81"><span class="toc-number">2.2.</span> <span class="toc-text">审计源码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#python%E8%A7%A3%E5%86%B3js%E5%8A%A0%E5%AF%86"><span class="toc-number">2.3.</span> <span class="toc-text">Python 解决 JS 加密</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E7%BC%96%E8%AF%91jsmap"><span class="toc-number">2.4.</span> <span class="toc-text">反编译 js.map [2]</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8C%85%E6%8E%A5%E5%8F%A3%E6%9E%84%E9%80%A0"><span class="toc-number">3.</span> <span class="toc-text">数据包接口构造</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#fuzz%E5%89%8D%E7%BD%AE%E7%9B%AE%E5%BD%95"><span class="toc-number">3.1.</span> <span class="toc-text">Fuzz 前置目录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E6%8E%A5%E5%8F%A3"><span class="toc-number">3.2.</span> <span class="toc-text">构造接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%8F%82%E6%95%B0"><span class="toc-number">3.3.</span> <span class="toc-text">构造参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%84%E9%80%A0js%E6%96%87%E4%BB%B6"><span class="toc-number">3.4.</span> <span class="toc-text">构造 JS 文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fuzz%E7%88%86%E7%A0%B4%E6%8E%A5%E5%8F%A3%E8%B7%AF%E5%BE%84"><span class="toc-number">3.5.</span> <span class="toc-text">Fuzz 爆破 &#x2F; 接口路径</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#js%E9%80%86%E5%90%91"><span class="toc-number">4.</span> <span class="toc-text">JS 逆向</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9A%E4%BD%8D%E5%8A%A0%E5%AF%86%E5%8F%82%E6%95%B0%E6%96%B9%E5%BC%8F"><span class="toc-number">4.1.</span> <span class="toc-text">定位加密参数方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%88%B1%E6%8B%8D%E6%A1%88%E4%BE%8B-md5"><span class="toc-number">4.2.</span> <span class="toc-text">爱拍案例 MD5</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#0x01-%E5%A0%86%E6%A0%88%E5%AF%BB%E6%89%BE%E5%8A%A0%E5%AF%86%E5%87%BD%E6%95%B0"><span class="toc-number">4.2.1.</span> <span class="toc-text">0X01 堆栈寻找加密函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x02-%E8%B7%9F%E5%85%A5%E5%87%BD%E6%95%B0%E5%86%85%E9%83%A8"><span class="toc-number">4.2.2.</span> <span class="toc-text">0X02 跟入函数内部</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x03-%E5%B7%A5%E5%85%B7%E7%94%9F%E6%88%90%E7%AE%97%E6%B3%95"><span class="toc-number">4.2.3.</span> <span class="toc-text">0X03 工具生成算法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BF%AB%E4%B9%90%E5%AD%A6%E5%A0%82-des"><span class="toc-number">4.3.</span> <span class="toc-text">快乐学堂 DES</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BF%BC%E9%BE%99%E8%B4%B7-des"><span class="toc-number">4.4.</span> <span class="toc-text">翼龙贷 DES</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sign-%E9%80%86%E5%90%91"><span class="toc-number">4.5.</span> <span class="toc-text">sign 逆向</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#python%E7%94%9F%E6%88%90sign%E5%8E%9F%E7%90%86"><span class="toc-number">4.5.1.</span> <span class="toc-text">Python 生成 sign 原理</span></a></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/2024/02/19/%E5%8A%A0%E8%A7%A3%E5%AF%86/" rel="bookmark" title="加解密算法逆向密文">加解密算法逆向密文</a></li><li class="active"><a href="/2024/03/29/JS%E9%80%86%E5%90%91/" rel="bookmark" title="JSFuzz-逆向构造数据包">JSFuzz-逆向构造数据包</a></li><li><a href="/2024/05/19/%E4%BA%91%E5%AE%89%E5%85%A8/" rel="bookmark" title="云安全攻防">云安全攻防</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="月" data-src="/images/avatar.jpg"><p class="name" itemprop="name">月</p><div class="description" itemprop="description">你越安静 你听到的就越多</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">25</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">7</span> <span class="name">分类</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL0x1bmFSR29k" title="https:&#x2F;&#x2F;github.com&#x2F;LunaRGod"><i class="ic i-github"></i></span> <span class="exturl item twitter" data-url="aHR0cHM6Ly94LmNvbS95dWVzZTEwMjkxMDQ1Mw==" title="https:&#x2F;&#x2F;x.com&#x2F;yuese102910453"><i class="ic i-twitter"></i></span> <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS9mZW5nLWppYW4tNDgtNjc=" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;feng-jian-48-67"><i class="ic i-zhihu"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTE2NjY5MDk3ODQ=" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;1666909784"><i class="ic i-cloud-music"></i></span> <span class="exturl item email" data-url="bWFpbHRvOnNhYmVyMGRheUBxcS5jb20=" title="mailto:saber0day@qq.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2024/02/19/%E5%8A%A0%E8%A7%A3%E5%AF%86/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2024/04/29/%E5%9F%9F%E9%98%B2%E7%81%AB%E5%A2%99/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E4%BB%A3%E7%90%86/" title="分类于 内网隧道代理">内网隧道代理</a></div><span><a href="/2024/04/29/%E5%9F%9F%E9%98%B2%E7%81%AB%E5%A2%99/" title="域防火墙规则策略 &amp; 隧道代理区别">域防火墙规则策略 & 隧道代理区别</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/" title="分类于 漏洞复现">漏洞复现</a></div><span><a href="/2023/01/02/Jboss%E6%9C%AA%E6%8E%88%E6%9D%83/" title="Jboss未授权 CVE-2017-7504">Jboss未授权 CVE-2017-7504</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/" title="分类于 漏洞复现">漏洞复现</a></div><span><a href="/2023/03/29/Strust2/" title="S2-001 RCE">S2-001 RCE</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2023/05/01/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" title="Java--多线程">Java--多线程</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E9%81%90%E6%83%B3and%E7%A2%8E%E7%A2%8E%E5%BF%B5/" title="分类于 遐想and碎碎念">遐想and碎碎念</a></div><span><a href="/2024/11/18/%E8%BD%A8%E8%BF%B9/" title="轨迹">轨迹</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/" title="分类于 漏洞复现">漏洞复现</a></div><span><a href="/2023/01/29/ApacheShiro%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="Apache  Shiro 反序列化">Apache Shiro 反序列化</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%B8%97%E9%80%8F%E9%9D%B6%E5%9C%BAWP/" title="分类于 渗透靶场WP">渗透靶场WP</a></div><span><a href="/2024/07/01/DC/" title="DC-1靶场">DC-1靶场</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E4%BB%A3%E7%90%86/" title="分类于 内网隧道代理">内网隧道代理</a></div><span><a href="/2024/05/01/%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/" title="隧道技术&amp; DNS&#x2F;SSH Linux反向上线">隧道技术& DNS/SSH Linux反向上线</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%B8%97%E9%80%8F%E9%9D%B6%E5%9C%BAWP/" title="分类于 渗透靶场WP">渗透靶场WP</a></div><span><a href="/2024/07/18/%E7%BA%A2%E6%97%A5%E5%AE%89%E5%85%A82/" title="红日安全vulnstack (二)">红日安全vulnstack (二)</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%86%85%E7%BD%91%E6%94%BB%E9%98%B2/" title="分类于 内网攻防">内网攻防</a></div><span><a href="/2024/09/19/%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8%E5%88%A9%E7%94%A8/" title="横向移动利用总结">横向移动利用总结</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2023 – <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">月 @ LunaRGFod</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">151k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">2:18</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2024/03/29/JS逆向/",favicon:{show:"Monthlblog",hide:"Monthlyblog"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>